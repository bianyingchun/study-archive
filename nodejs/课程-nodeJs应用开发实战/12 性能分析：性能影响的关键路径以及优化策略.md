### 性能分析工具

1. 压测所使用到的 WRK（Windows Research Kernel）

2. 性能分析所使用到的 Chrome 分析工具 JavaScript Profile。

用 Chrome 的开发者工具 More-tools → JavaScript Profiler → Load，读取 CPU Profile，查看火焰图。

要使用这个功能，需要在 Node.js 中对 CPU 进行采集，采集的方式需要使用 **v8-profiler** 这个库（如果你的 Node.js 版本大于 10，则需要使用 v8-profiler-next 这个库）

### 优化方案

#### CPU 计算耗时

减少操作，或者减少运算，增加计算的缓存，避免多次相同的计算

#### 网络 I/O

1. 增加缓存，避免重复的请求导致的问题

2. 放弃部分超时请求，从而提升服务性能

#### 磁盘 I/O

磁盘 I/O 的优化分为读优化和写优化，优化的策略有：

1. 为了提升性能需要将同步修改**异步**，避免影响主线程的性能；

2. 读优化，必须增加必要的**缓存**，减少相同文件的重复读取；

3. 写优化，**可以使用异步写文件的方式，先将写内容缓存到队列**（如我们第一部分的第 08 讲的方案）；

4. **合并多次写操作**，避免频繁打开文件，读写文件内容。
