[参考链接](https://github.com/lgwebdream/FE-Interview/issues/16)

### XSS(跨站脚本攻击)

跨站脚本攻击。它指的是恶意攻击者往 Web 页面里插入恶意 html 代码，当用户浏览该页之时，嵌入其中 Web 里面的 html 代码会被执行，从而达到恶意用户的特殊目的。

#### 分类

xss 攻击可以分成两种类型：

1. 非持久型攻击
   非持久型 xss 攻击：顾名思义，非持久型 xss 攻击是一次性的，仅对当次的页面访问产生影响。非持久型 xss 攻击要求用户访问一个被攻击者篡改后的链接，用户访问该链接时，被植入的攻击脚本被用户游览器执行，从而达到攻击目的。
2. 持久型攻击

持久型 xss 攻击：持久型 xss，会把攻击者的数据存储在服务器端，攻击行为将伴随着攻击数据一直存在。

也可以分成三类:

1. 反射型：经过后端，不经过数据库

- 场景：通过 URL 传递参数的功能，如网站搜索、跳转等。
- 攻击步骤：
  - 攻击者构造出特殊的 URL，其中包含恶意代码。
  - 用户打开带有恶意代码的 URL 时，网站服务端将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器。
  - 用户浏览器接收到响应后解析执行，混在其中的恶意代码也被执行。
  - 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

2. 存储型：经过后端，经过数据库

- 场景：见于带有用户保存数据的网站功能，如论坛发帖、商品评论、用户私信等。
- 攻击步骤：
  - 攻击者将恶意代码提交到目标网站的数据库中
  - 用户打开目标网站时，服务端将恶意代码从数据库中取出来，拼接在 HTML 中返回给浏览器
  - 用户浏览器在收到响应后解析执行，混在其中的恶意代码也同时被执行
  - 恶意代码窃取用户数据，并发送到指定攻击者的网站，或者冒充用户行为，调用目标网站的接口，执行恶意操作

3. DOM 型:不经过后端。

- 场景：通过 URL 传递参数的功能，如网站搜索、跳转等。
- 攻击步骤:
  - 攻击者构造出特殊的 URL，其中包含恶意代码。
  - 用户打开带有恶意代码的 URL。
  - 用户浏览器接收到响应后解析执行，前端 JavaScript 取出 URL 中的恶意代码并执行。
  - 恶意代码窃取用户数据并发送到攻击者的网站，或者冒充用户的行为，调用目标网站接口执行攻击者指定的操作。

#### 预防方案

防止攻击者提交恶意代码，防止浏览器执行恶意代码）

1. **对数据进行严格的输出编码**：如 HTML 元素的编码，JS 编码，CSS 编码，URL 编码等等
   - 避免拼接 HTML；Vue/React 技术栈，避免使用 v-html / dangerouslySetInnerHTML
2. **CSP HTTP Header**，即 Content-Security-Policy、X-XSS-Protection
   增加攻击难度，配置 CSP(本质是**建立白名单，由浏览器进行拦截**)

   - Content-Security-Policy: default-src 'self' -所有内容均来自站点的同一个源（不包括其子域名）
   - Content-Security-Policy: default-src 'self' \*.trusted.com-允许内容来自信任的域名及其子域名 (域名不必须与 CSP 设置所在的域名相同)
   - Content-Security-Policy: default-src https://yideng.com-该服务器仅允许通过HTTPS方式并仅从yideng.com域名来访问文档

3. **输入验证**：比如一些常见的数字、URL、电话号码、邮箱地址等等做校验判断

4. **开启浏览器 XSS 防御：Http Only cookie**，禁止 JavaScript 读取某些敏感 Cookie，攻击者完成 XSS 注入后也无法窃取此 Cookie。

5. 验证码

---

### CSRF：跨站请求伪造

跨站请求攻击，简单地说，是攻击者通过一些技术手段欺骗用户的浏览器去访问一个自己曾经认证过的网站并运行一些操作（如发邮件，发消息，甚至财产操作如转账和购买商品）。由于浏览器曾经认证过，所以被访问的网站会认为是真正的用户操作而去运行。
